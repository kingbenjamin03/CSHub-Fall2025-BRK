@(id: String, userForm: play.data.Form[models.User], user: User, organizations: List[Organization], researcherInfo: ResearcherInfo, studentInfo: StudentInfo)
    @import helper._
    @scripts = {
        <script type="text/javascript" src='@routes.Assets.at("javascripts/database_field_length.js")'></script>
        <script type="text/javascript" src='@routes.Assets.at("javascripts/field_validation_helper.js")'></script>
        <script type="text/javascript">
                var projectList = [];
                $(document).ready(function () {
                    /**
                     * This portion defines all the (non)required fields that need validation on max lengths and special
                     * characters, as well as URL validity.
                     */
                    validateField("firstName", "firstNameMsg", "varChar255", true);
                    validateField("lastName", "lastNameMsg", "varChar255", true);
                    validateField("middleInitial", "middleInitialMsg", "varChar255", false);
                    validateField("researchFields", "researchFieldsMsg", "varChar255", false);
                    validateField("organization", "organizationMsg", "varChar255", false);
                    validateField("mailingAddress", "mailingAddressMsg", "varChar255", false);
                    // validateField("highestDegree", "highestDegreeMsg", "varChar255", false);
                    validateField("phoneNumber", "phoneNumberMsg", "varChar20", false);
                    /****************************** End of Validation Portion ******************************************/

                    // $.get("/project/getProjects", function (res) {
                    //     projectList = res;
                    //     var availableObj = {};
                    //     for (var i = 0; i < projectList.length; i++) {
                    //         availableObj[projectList[i]['text']] = null;
                    //     }
                    //     $('#projectName').autocomplete({
                    //         data: availableObj
                    //     });
                    // });
                });

                /**
                 * This method triggers the user image change
                 */
                function updateImg() {
                    document.getElementById("Img").click();
                }

                /**
                 * This method previews the selected image for update
                 */
                function changepic() {
                    if (document.getElementById("Img").value == "") return;
                    var reads = new FileReader();
                    f = document.getElementById("Img").files[0];
                    reads.readAsDataURL(f);
                    reads.onload = function (e) {
                        document.getElementById('showImg').src = this.result;
                        $('#record').val("update");
                        $('#previewMsg').text("This is the preview image. You need to click \"SAVE\" button below if you want to save the changes.");

                    };
                }

                /**
                 * This method deletes the image and provides the default image for user
                 */
                function deleteImg() {
                    url = "../../../../assets/images/user.png";
                    document.getElementById('showImg').src = url;
                    $('#record').val("delete");
                    $('#previewMsg').text("This is the default image. You need to click \"UPDATE\" button below if you want to save the changes.");
                }

                function otherOrganization() {
                    var inputOtherOrganization = document.getElementById("organization");
                    var selectedIndex = inputOtherOrganization.selectedIndex;
                    var selectedValue = inputOtherOrganization.options[selectedIndex].value;
                    document.getElementById("hiddenOrganization").hidden = !(selectedValue == "-1");
                    document.getElementsByName("hiddenOrganization")[0].required = (selectedValue == "-1");
                }

                /**
                 * This method parses and sets up default project based on input.
                 * If not set or opennex typed, the project is set to OpenNEX. Otherwise check the name.
                 */
                function projectValidation() {
                    if ($("#projectName").val() == "") {
                        document.getElementById("project-msg").innerHTML = "";
                        document.getElementById("projectName").value = "OpenNEX";
                        document.getElementById("projectId").value = "0";
                        if ($('#msg').text() == "" && $('#homepage-msg').text() == "") {
                            document.getElementById("Save").disabled = false;
                        }
                        return;
                    }
                    var project = $("#projectName").val();
                    var pid = 0;
                    if (project.toLowerCase() === "opennex") {
                        document.getElementById("projectId").value = "0";
                        document.getElementById("project-msg").innerHTML = "";
                        if ($('#msg').text() == "" && $('#homepage-msg').text() == "") {
                            document.getElementById("Save").disabled = false;
                        }
                    } else {
                        found = false;
                        for (var i = 0; i < projectList.length; i++) {
                            if (projectList[i]['text'].toLowerCase().trim() === project.toLowerCase().trim()) {
                                found = true;
                                document.getElementById("projectId").value = projectList[i]['id'];
                                break;
                            }
                        }
                        if (!found) {
                            document.getElementById("project-msg").innerHTML = "Project does not exist";
                            document.getElementById("Save").disabled = true;
                        } else {
                            document.getElementById("project-msg").innerHTML = "";
                            if ($('#msg').text() == "" && $('#homepage-msg').text() == "") {
                                document.getElementById("Save").disabled = false;
                            }
                        }
                    }

                }

                function checkFileSizeBeforeSubmit() {
                    var fileInput = document.getElementById("Img");
                    if (!fileInput.value) {
                        return true;
                    }
                    var file = fileInput.files[0];
                    if (file && file.size > 3 * 1024 * 1024) {
                        alert("The image size cannot exceed 3MB, please reselect.");
                        return false;
                    }
                    return true;
                }
        </script>
    }

@main("Account Management", scripts) {
    <div class="container row">
        <div class="col s12">
            <div class="card-panel">
                <form class="form-signin" id="update" enctype="multipart/form-data" method="post" action="@routes.UserController.userEditPOST()" onsubmit="return checkFileSizeBeforeSubmit()">
                    <h4 class="form-signin-heading" align="center">Edit Your Profile</h4>
                    <div class="row">
                        <div class="col s8">
                            <h6 class="col s6" align="left">Immutable</h6>
                            <div class="col s12">
                                <table class="striped responsive-table">
                                    <tbody>
                                        <tr>
                                            <th>User ID</th>
                                            <td>@user.getId</td>
                                        </tr>
                                        <tr>
                                            <th>User Email Address</th>
                                            <td>@user.getEmail</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col center s3">
                            <tr>
                                <th>Picture:</th>
                                <td>
                                    <img class="circle" id="showImg" src="@routes.Application.getImageFromPath(user.getAvatar())" width="360" height="360" style="border-width: 1px;
                                        border-style: solid;
                                        border-radius: 50%;
                                        height: auto;
                                        width: 70%;">
                                    <div id="previewMsg" style="color: blue"></div>
                                    <br>
                                    <div>
                                        <a class="btn-floating waves-effect waves-light blue darken-2" title="Update Image" href="javascript:void(0)" onclick="updateImg(@user.getId)"><i class="material-icons">
                                            edit</i><input type="file" id="Img" name="avatar" style="display: none;" accept=".jpeg,.png,.jpg" onchange="changepic(this)"/></a>  &nbsp;
@*                                        <a class="btn-floating waves-effect waves-light red modal-trigger" title="Delete Image" href="javascript:void(0)" onclick="deleteImg(@user.getId)"><i class="material-icons">*@
@*                                            delete</i></a>*@
                                        <input id="record" name = "record" style="display: none;"/>
                                    </div>
                                </td>
                            </tr>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <h6 class="col s12" align="left">Editable</h6>
                            <div class="row">
                                <div class="input-field col s12 m4 l4">
                                    <input id="firstName" type="text" class="validate" name="firstName"
                                    onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123) || event.charCode === 32" onpaste="return false" value="@user.getFirstName" required>
                                    <label for="firstName">First Name* </label>
                                    <span id="firstNameMsg" class="helper-text" data-error=""></span>
                                </div>
                                <div class="input-field col s12 m4 l4">
                                    <input id="middleInitial" type="text" class="validate" name="middleInitial"
                                    onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123) || event.charCode === 32" onpaste="return false" value="@if(user.getMiddleInitial!="null") {@user.getMiddleInitial}">
                                    <label for="middleInitial">Middle Name</label>
                                    <span id="middleInitialMsg" class="helper-text" data-error=""></span>
                                </div>
                                <div class="input-field col s12 m4 l4">
                                    <input id="lastName" type="text" class="validate" name="lastName"
                                    onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123) || event.charCode === 32" onpaste="return false" value="@user.getLastName" required>
                                    <label for="lastName">Last Name*</label>
                                    <span id="lastNameMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>
@*                            <div class="row">*@
@*                                <div class="input-field col s12">*@
@*                                    @if(user.getProjectZone() != null && user.getProjectZone().getId()!=0) {*@
@*                                        <input type="text" name="projectName" id = "projectName" onchange="projectValidation()" class="validate autocomplete" value="@user.getProjectZone().getTitle()">*@
@*                                    } else {*@
@*                                        <input type="text" name="projectName" id = "projectName" onchange="projectValidation()" class="validate autocomplete" value="OpenNEX">*@
@*                                    }*@
@*                                    <label for="project">*@
@*                                        Default Project Zone<i class=" tiny material-icons tooltipped" data-position="bottom" data-tooltip="Selecting a default project allows you to only view APIs, dockers, notebooks, and datasets associated with the given project while you work in OpenNEX.">*@
@*                                        help</i></label>*@
@*                                    <div class="form-group" id="project-msg" style="color: red;"></div>*@
@*                                    <input hidden name="projectId" id="projectId" value='0'>*@
@*                                </div>*@
@*                            </div>*@
@*                            <div class="row">*@
@*                                <div class="input-field col s12">*@
@*                                    <input type="text" name="organization" id="organization" class="validate" value='@if(user.getOrganization!="null") {@user.getOrganization}'>*@
@*                                    <label for="organization">Organization</label>*@
@*                                    <span id="organizationMsg" class="helper-text" data-error=""></span>*@
@*                                </div>*@
                            <div class="row">
                                <div class="input-field col s12">
                                    <select id="organization" name="organization" onchange="otherOrganization()" required>
                                        @for((org, idx) <- organizations.zipWithIndex) {
                                            <option value="@org.getId()">@org.getOrganizationName()</option>
                                        }
                                        @*                                        <option value="@organizations.get(0).getId()" selected="false">@organizations.get(0).getOrganizationName()</option>*@
                                        @*                                        <option value="">vad</option>*@
                                    </select>
                                    @*                                    <input type="text" name="organization" id="organization" class="validate">*@
                                    <label for="organization">Organization</label>
                                    <span id="organizationMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>

                            <div class="row" hidden="true" id="hiddenOrganization">
                                <div class="input-field col s12">
                                    <input type="text" name="hiddenOrganization" class="validate">
                                    <label for="hiddenOrganization">Other Organization*</label>
                                    <span id="hiddenOrganizationMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>

@*                            </div>*@
@*                            <div class="row">*@
@*                                <div class="input-field col s12">*@
@*                                    <input type="text" name="title" id="title" class="validate" value='@if(user.getTitle!="null") {@user.getTitle}'>*@
@*                                    <label for="title">Title</label>*@
@*                                    <span id="titleMsg" class="helper-text" data-error=""></span>*@
@*                                </div>*@
@*                            </div>*@
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="text" name="homepage" id="homepage" class="validate" value='@if(user.getHomepage != "null") {@user.getHomepage}'>
                                    <label for="homepage">Personal Website URL</label>
                                    <span id="urlMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>
                            @*<div class="row">
                                <div class="input-field col s12">
                                    <input
                                    type="url" name="homepage" id="homepage" class="validate" onchange="validateRegex(this.id, 'URL')">
                                    <label for="homepage">
                                        Personal URL </label>
                                    <span id="urlMsg" class="helper-text" data-success="âœ“" data-error="Please input a valid URL"></span>
                                </div>*@
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="text" name="mailingAddress" id="mailingAddress" class="validate" value='@if(user.getMailingAddress!="null") {@user.getMailingAddress}'>
                                    <label for="mailingAddress">Mailing Address</label>
                                    <span id="mailingAddressMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="text" name="phoneNumber" id="phoneNumber" class="validate" value='@if(user.getPhoneNumber!="null") {@user.getPhoneNumber}'>
                                    <label for="phoneNumber">Phone Number</label>
                                    <span id="phoneNumberMsg" class="helper-text" data-error=""></span>
                                </div>
                            </div>

                            @if(user.getUserType() == 1) {
                                <div class="row">
                                    <div class="input-field col s12">
                                        <input type="text" name="highestDegree" id="highestDegree" class="validate"
                                        value='@if(researcherInfo != null && researcherInfo.getHighestDegree() != "null") { @researcherInfo.getHighestDegree() }'>
                                        <label for="highestDegree">Highest Degree</label>
                                        <span id="highestDegreeMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="text" name="orcid" id="orcid" class="validate"
                                        value='@if(researcherInfo != null && researcherInfo.getOrcid() != "null") { @researcherInfo.getOrcid() }'>
                                        <label for="orcid">ORCID</label>
                                        <span id="orcidMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="text" name="researchFields" id="researchFields" class="validate"
                                        value='@if(researcherInfo != null && researcherInfo.getResearchFields() != "null") { @researcherInfo.getResearchFields() }'>
                                        <label for="researchFields">Research Fields</label>
                                        <span id="researchFieldsMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="text" name="school" id="school" class="validate"
                                        value='@if(researcherInfo != null && researcherInfo.getSchool() != "null") { @researcherInfo.getSchool() }'>
                                        <label for="school">School</label>
                                        <span id="schoolMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="text" name="department" id="department" class="validate"
                                        value='@if(researcherInfo != null && researcherInfo.getDepartment() != "null") { @researcherInfo.getDepartment() }'>
                                        <label for="department">Department</label>
                                        <span id="departmentMsg" class="helper-text" data-error=""></span>
                                    </div>
                                </div>
                            }

                            @if(user.getUserType() == 4) {
                                <div class="row">
                                    <div class="input-field col s12">
                                        <input type="text" name="studentIdNumber" id="studentIdNumber" class="validate"
                                        value='@if(studentInfo != null && studentInfo.getIdNumber() != "null") { @studentInfo.getIdNumber() }'>
                                        <label for="studentIdNumber">ID #</label>
                                        <span id="studentIdNumberMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <select id="studentType" name="studentType">
                                            <option value="Undergraduate" @if(studentInfo != null && studentInfo.getStudentType() == "Undergraduate") { selected }>Undergraduate</option>
                                            <option value="Master" @if(studentInfo != null && studentInfo.getStudentType() == "Master") { selected }>Master</option>
                                            <option value="Ph.D." @if(studentInfo != null && studentInfo.getStudentType() == "Ph.D.") { selected }>Ph.D.</option>
                                            <option value="Other" @if(studentInfo != null && studentInfo.getStudentType() == "Other") { selected }>Other</option>
                                        </select>
                                        <label for="studentType">Type</label>
                                        <span id="studentTypeMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <select id="studentYear" name="studentYear">
                                            <option value="First" @if(studentInfo != null && studentInfo.getStudentYear() == "First") { selected }>First year</option>
                                            <option value="Second" @if(studentInfo != null && studentInfo.getStudentYear() == "Second") { selected }>Second year</option>
                                            <option value="Third" @if(studentInfo != null && studentInfo.getStudentYear() == "Third") { selected }>Third year</option>
                                            <option value="Forth" @if(studentInfo != null && studentInfo.getStudentYear() == "Forth") { selected }>Forth year</option>
                                            <option value="Fifth" @if(studentInfo != null && studentInfo.getStudentYear() == "Fifth") { selected }>Fifth year</option>
                                            <option value="Other" @if(studentInfo != null && studentInfo.getStudentYear() == "Other") { selected }>Other</option>
                                        </select>
                                        <label for="studentYear">Current academic year</label>
                                        <span id="studentYearMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="text" name="studentMajor" id="studentMajor" class="validate"
                                        value='@if(studentInfo != null && studentInfo.getMajor() != "null") { @studentInfo.getMajor() }'>
                                        <label for="studentMajor">Major</label>
                                        <span id="studentMajorMsg" class="helper-text" data-error=""></span>
                                    </div>
                                    <div class="input-field col s12">
                                        <input type="date" name="studentEnrollDate" id="studentEnrollDate" class="validate"
                                        value='@if(studentInfo != null && studentInfo.getFirstEnrollDate() != "null") { @studentInfo.getFirstEnrollDate() }'>
                                        <label for="studentEnrollDate">First Enrollment Date</label>
                                        <span id="studentEnrollDateMsg" class="helper-text" data-error=""></span>
                                    </div>
                                </div>
                            }

@*                            <div class="row">*@
@*                                <div class="input-field col s12">*@
@*                                    <input type="text" name="researchFields" id="researchFields" class="validate" value='@if(user.getResearchFields!="null") {@user.getResearchFields}'>*@
@*                                    <label for="researchFields">Research Fields</label>*@
@*                                    <span id="researchFieldsMsg" class="helper-text" data-error=""></span>*@
@*                                </div>*@
@*                            </div>*@
@*                            <div class="row">*@
@*                                <div class="input-field col s12">*@
@*                                    <input type="text" name="highestDegree" id="highestDegree" class="validate" value='@if(user.getHighestDegree!="null") {@user.getHighestDegree}'>*@
@*                                    <label for="highestDegree">Highest Degree</label>*@
@*                                    <span id="highestDegreeMsg" class="helper-text" data-error=""></span>*@
@*                                </div>*@
@*                            </div>*@
                            <input type="hidden" name="email" hidden value="@user.getEmail">

                            <div class="actions row">
                                <button id="Save" type="submit" class="btn waves-effect waves-light col s12 blue darken-2">
                                    Save<i class="material-icons right">save_alt</i></button>
                            </div>
                            <div class="actions row">
@*                                <a href="#warningModal" class="btn waves-effect waves-light col s5 red  modal-trigger">*@
@*                                    Delete Account<i class="material-icons right">delete_outline</i></a>*@
@*                                <div id="warningModal" class="modal">*@
@*                                    <div class="modal-content">*@
@*                                        <h5 style="color: red">Warning</h5>*@
@*                                        <p style="font-weight: bold">*@
@*                                            Do you really want to delete your account?*@
@*                                            Please note that after deletion, this account <span style="color: red">*@
@*                                            CANNOT</span> be recovered!</p>*@
@*                                    </div>*@
@*                                    <div class="modal-footer">*@
@*                                        <a href="#!" class="modal-close waves-effect waves-green btn-flat">*@
@*                                            Cancel</a>*@
@*                                        <a href='@routes.UserController.userDelete()'*@
@*                                        class="modal-close waves-effect waves-green btn-flat">Confirm</a>*@
@*                                    </div>*@
@*                                </div>*@
                                <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
                                    <a href="/" class="btn waves-effect waves-light col s5 offset-s2 grey"
                                    style="transform: translateX(-90px);">
                                        Cancel<i class="material-icons right">cancel</i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
}