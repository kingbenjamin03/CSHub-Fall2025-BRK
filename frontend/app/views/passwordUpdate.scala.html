@(userForm: play.data.Form[models.User], userId: String, email: String)
@import helper._

@scripts = {
    <script type="text/javascript" src='@routes.Assets.at("javascripts/database_field_length.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/field_validation_helper.js")'></script>
    <script type="text/javascript">
            var isPasswordNotMatched = true;
            var isPasswordNotSecure = false;

            var passwordNotSecureError = "Password must contain at least one special character, one uppercase, and one lowercase letter, and at least 8 or more characters <br/>";
            var passwordsDoNotMatchError = "Your password and confirmation password do not match. <br/>";


            function checkFormValid() {
                if(isPasswordNotMatched){
                    document.getElementById("warningMessage").innerText = "Your password and confirmation password do not match.";
                    $("#warningModal").modal();
                    $("#warningModal").modal('open');
                    return false;
                }

                return true;
            }

            /**
             * This function checks the password entries are the same
             */
            function checkPwd() {
                var p1 = document.getElementById("password").value;
                var p2 = document.getElementById("repassword").value;
                if (p1 !== p2) {
                    isPasswordNotMatched = true;
                    document.getElementById("repasswordMsg").innerHTML = "Your password and confirmation password do not match."
                } else {
                    isPasswordNotMatched = false;
                    document.getElementById("repasswordMsg").innerHTML = ""
                }
            }

            function doesPasswordFailRules(){
                return false;
            }

    </script>
}

@main("Update password", scripts) {
    <div class="container">
        <div class="row">
            <div class="col s12 l10 offset-l1">
                <div class="card-panel z-depth-0">
                    <h4 class="form-update-password-heading center">Update your new password</h4>
                    <form class="form-update-password" onsubmit="return checkFormValid();" enctype="multipart/form-data" method="post" action="@routes.UserController.updatePasswordForUser()">
                        <div class="row">
                            <div class="input-field col s12 m6">
                                <input type="password" name="password" id="password" class="validate" required  onchange="checkPwd()">
                                <label for="password">Password*</label>
                                <span id="passwordMsg" class="helper-text" data-error=""></span>
                            </div>
@*                        </div>*@
@*                        <div class="row">*@
                            <div class="input-field col s12 m6">
                                <input type="password" name="repassword"   id="repassword" class="validate" required onchange="checkPwd()">
                                <label for="repassword">Re-enter Password*</label>
                                <span id="repasswordMsg" class="helper-text" data-error="" style="color: red"></span>
                            </div>
                        </div>
                        <div class="row" hidden="true">
                            <input type="text" name="email" id="email" value="@email" />
                            <input type="text" name="id" id="id" value="@userId" />
                        </div>

                        <div id="warningModal" class="modal">
                            <div class="modal-content">
                                <h5 class="center" style="color: red">Warning!</h5>
                                <h6 class="center" style="font-weight: bold" id="warningMessage"></h6>
                            </div>
                        </div>
                        <div class="center actions row">
                            <div class="input-field col s12">
                                <button type="submit" class="btn waves-effect waves-light blue darken-2" id="save">
                                    Save</button>
                                <a href="@routes.Application.home()" class="btn waves-effect waves-light red darken-2">Cancel</a>
                                <div class="helper-text red-text" id="submitErrorMsg"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script >
            var requiredFieldList = ["password", "repassword"];
            var notRequiredFieldList = [];
            setPattern(requiredFieldList, notRequiredFieldList, 'user');
    </script>
}