@(userForm: play.data.Form[models.User], email: String)
@scripts = {
    <script type="text/javascript">
        var passwordIsValid = false;
            function checkpwd(){
                var p1=document.getElementById("new_password").value;
                var p2=document.getElementById("confirm_password").value;
                if(p1!=p2){
                    document.getElementById("msg").innerHTML="Please check that your passwords match";
                    document.getElementById("submitBtn").disabled = true;

                }else{
                    document.getElementById("msg").innerHTML = "";
                    document.getElementById("submitBtn").disabled = false;
                    return true;
                }
            }
            function checkTempwd() {
                document.getElementById("submitMsg").innerHTML = "";
                var obj =  {
                    "pwd" : $("#current_password").val(),
                    "email" : "@email"
                };
                $.ajax({
                    url: "/user/checkCurPassword",
                    data: JSON.stringify(obj),
                    type: "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    success: function(response) {
                        if ("error" === response) {
                            document.getElementById("msg1").innerHTML = "Temporary password is invalid.";
                            document.getElementById("submitBtn").disabled = true;
                            passwordIsValid = false;
                            return;
                        }
                        document.getElementById("submitBtn").disabled = false;
                        document.getElementById("msg1").innerHTML = "";
                        passwordIsValid = true;
                    }
                })

            }

            function validateAgreement(){
                if(!passwordIsValid){
                    document.getElementById("submitMsg").innerHTML = "Temporary password is invalid.";
                }
                return passwordIsValid;
            }
    </script>
}
@main("Update Password", scripts) {
        <div class="container">
            <div class="row">
                <div class="col s12 m10 offset-m1">
                    <div class="card-panel">
                        <form class="form-signin" enctype="multipart/form-data" onsubmit="return validateAgreement();" id="registerationForm" method="post" action="@routes.UserController.updatePassword">
                            <h4 class="center">Please check your mailbox.</h4>
                            <h6 class="center">A temporary password has been sent to your provided email address.</h6>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="password" onchange = "checkTempwd()" name="current_password" id="current_password" class="validate" required>
                                    <label for="current_password">Temporary Password</label>
                                    <div class="helper-text red-text" id="msg1"></div>
                                    <div class="helper-text red-text" id="msg1"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="password" name="new_password" id="new_password" class="validate" required>
                                    <label for="new_password">New Password</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input type="password" name="confirm_password" id="confirm_password" class="form-control" required="" oninput="checkpwd()">
                                    <label for="confirm_password">Confirm Password</label>
                                    <div class="helper-text red-text" id="msg"></div>
                                </div>
                            </div>
                            <input type="hidden" name="email"  value='@email'>
                            <div class="actions row">
                                <div class="input-field col s12 center">
                                    <button class="btn waves-effect waves-light blue darken-2" type = "submit" id="submitBtn">Submit</button>
                                    <div class="helper-text red-text" id="submitMsg"></div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
}